(function(){var f={_options:{},_actionIndex:-1,init:function(a,c){var b=this;this._elem=jQuery(a);this._options=jQuery.extend(this.getDefaultOptions(),c);this._loader=this._elem.find(".mmtl-loader");this._output=this._elem.find(".mmtl-output");this._submit=this._elem.find('input[type="submit"]');this.on("action_before",function(a,c,e){b._elem.find(".mmtl-ajax-hide-on-before").hide();b._submit.prop("disabled",!0).hide();b._loader.show()});this.on("action_complete_success",function(a,c,e,f){b._output.append(f);
b._actionIndex+1>=b.option("actions").length||b.doAction(++b._actionIndex)});this.on("action_complete_error",function(a,b,c){});this.on("action_complete",function(a,c,e){e<b._actionIndex||(b._submit.prop("disabled",!1),b._elem.find(".mmtl-ajax-hide-on-complete").hide(),b._elem.find(".mmtl-ajax-show-on-complete").show(),b._loader.hide())});this.on("action_error",function(a,b,c){});this._elem.find("form").submit(function(a){b._actionIndex=0;b.doAction(b._actionIndex);return!1})},option:function(a){return this._options[a]},
getAction:function(a){var c=this.option("actions");return 0>a||a>c.length?null:c[a]},doAction:function(a){var c=this.getAction(a);if(c){var b={},b=(b.action="mmtl_updater_process_action",b.action_id=c,b[this.option("noncename")]=this.option("nonce"),b),d=this;this.trigger("action_before",[c,a]);return jQuery.post(this.option("ajaxurl"),b).done(function(b){b.hasOwnProperty("success")&&b.success?d.trigger("action_complete_success",[c,a,b.data]):d.trigger("action_complete_error",[c,a,b.data])}).fail(function(){d.trigger("action_error",
[c,a])}).always(function(){d.trigger("action_complete",[c,a])})}},trigger:function(){var a=Array.prototype.slice.call(arguments);0<a.length&&(a[0]="mmtl_updater:"+a[0]);jQuery(document).trigger.apply(jQuery(document),a)},on:function(){var a=Array.prototype.slice.call(arguments);0<a.length&&(a[0]="mmtl_updater:"+a[0]);jQuery(document).on.apply(jQuery(document),a)},getDefaultOptions:function(){return{ajaxurl:"",nonce:"",noncename:"",actions:[]}}};jQuery(document).ready(function(){f.init("#mmtl-updater-screen",
MMTL_Updater_Options)})})();